import os
from os import listdir
from os.path import isfile, join
import re
import string
import nltk

NO_AB = '***NO ABSTRACT_STRING FOUND***'

def find_abstract_one_match(text):
    reg_term = r"abstract[\s\S]{1,3400}[\S]*"##length of 3400 grabs most abstracts in db

    regex = re.compile(reg_term,re.IGNORECASE)
    matches = re.findall(regex,text)
    if(len(matches) == 1):
        return matches[0]
    elif(len(matches) > 1):
        return matches[0]
    else:
        print(NO_AB)
        return NO_AB

def clean_text(text):
    text = re.sub(r"\\[a-zA-Z][0-9]+?", " ",text)
    text = re.sub(r"\\[a-zA-Z]", " ",text)
    text = re.sub(r"([\s]{1,2}[0-9]){2,}"," ",text)
    text = re.sub(r" e2 "," ",text)
    text = re.sub(r"c2 a0"," ",text)

    while '  ' in text:
        text = text.replace('  ',' ')

    return text

def clean_ab_chunk(text):
    text = re.sub(r"introduction.+|i ntroduction.+", "  **INTRO REMOVED**  ",text,flags=re.IGNORECASE)
    text = re.sub(r"main text.+", "  **MAIN TEXT REMOVED**  ",text,flags=re.IGNORECASE)
    text = re.sub(r"ABSTRACT.+ABSTRACT", "  **NON ABSTRACT REMOVED**  ",text,flags=re.IGNORECASE)
    text = re.sub(r"KEYWORDS.+", "  **KEYWORDS REMOVED**  ",text,flags=re.IGNORECASE)
    text = re.sub(r"KEY WORDS.+", "  **KEYWORDS REMOVED**  ",text,flags=re.IGNORECASE)
    text = re.sub(r"http[\S]+\/\/[\S]+\.[\S]+","  **HTTP REMOVED**  ",text,flags=re.IGNORECASE)
    text = re.sub(r"[\S]+@[A-Z]+\.[\S]+", "  **EMAIL REMOVED**  ", text,flags=re.IGNORECASE)

    text = re.sub(r"ABSTRACT", "  **ABSTRACT**  ",text,flags=re.IGNORECASE)
    return text

def clean_removed_strings(text):
    rs  = ['**INTRO REMOVED**',
           '**MAIN TEXT REMOVED**',
           '**NON ABSTRACT REMOVED**',
           '**KEYWORDS REMOVED**',
           '**HTTP REMOVED**',
           '**EMAIL REMOVED**',
           '**ABSTRACT**'
           ]

    for r in rs:
        if r in text:
            text = text.replace(r,' ')
    while '  ' in text:
        text = text.replace('  ',' ')
    return text

def test():
    t = "bioRxiv preprint first posted online Feb. 15, 2019; doi: http://dx.doi.org/10.1101/550582. The copyright holder for this preprint\n(which was not peer-reviewed) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity.\nIt is made available under a CC-BY-NC-ND 4.0 International license.\n\nAttacked from above and below, new observations of cooperative and solitary\npredators on roosting cave bats\nKrizler Cejuela. Tanalgo1, 2, 3, 7*, Dave L. Waldien 4, 5, 6, Norma Monfort6, Alice Catherine Hughes1, 3*\n1\nLandscape Ecology Group, Centre for Integrative Conservation, Xishuangbanna Tropical Botanical Garden,\nChinese Academy of Sciences, Menglun, Mengla, Yunnan Province 666303, People\xe2\x80\x99s Republic of China\n2\nInternational College, University of Chinese Academy of Sciences, Beijing 100049, People\xe2\x80\x99s Republic of\nChina\n3\nSoutheast Asia Biodiversity Research Institute, Chinese Academy of Sciences, Menglun, Mengla, Yunnan\nProvince 666303, People\xe2\x80\x99s Republic of China\n4\nHarrison Institute, Bowerwood House, 15 St Botolph\xe2\x80\x99s Road, Sevenoaks, Kent, TN13 3AQ, United Kingdom\n5\nChristopher Newport University, 1 Avenue of the Arts, Newport News, VA 23606, United States of America\n6\nPhilippine Bats for Peace Foundation Inc., 5 Ramona Townhomes, Guadalupe Village, Lanang, Davao City\n7\nDepartment of Biological Sciences, College of Arts and Sciences, University of Southern Mindanao, Kabacan\n9407, North Cotabato, the Republic of the Philippines\n\nCorresponding authors:\nACH (ach_conservation2@hotmail.com) and KCT (tkrizler@gmail.com)\nLandscape Ecology Group, Centre for Integrative Conservation, Xishuangbanna Tropical Botanical Garden,\nChinese Academy of Sciences, Menglun, Mengla, Yunnan Province 666303, People\xe2\x80\x99s Republic of China\n\nAbstract\nPredation of bats in their roosts has previously only been attributed to a limited number of\nspecies such as various raptors, owls, and snakes. However, in situations where due to over-crowding\nand limited roost space, some individuals may be forced to roost in suboptimal conditions, such as\naround the entrances of caves and may thus be vulnerable to predation by species which would\nnormally be unlikely to predate bats whilst roosting inside caves. Here, we describe the first\ndocumented cooperative hunting of the Large-billed Crow, Corvus macrorhynchos Wagler, 1827\n(Passeriformes: Corvidae) and opportunistic predation by the Yellow-headed water monitor, Varanus\ncumingi Martin, 1839 (Squamata: Varanidae) in the world\xe2\x80\x99s largest colony of Geoffroy's Rousette,\nRousettus amplexicaudatus (\xc3\x89. Geoffroy Saint-Hilaire, 1810) (Chiroptera: Pteropidae) in the Island of\nSamal, Mindanao, Philippines.\nKeywords: bats, caves, Cooperative behaviour, Corvus, prey-predator, Varanus.\n\nIntroduction\nAnimal feeding behaviour i.e., to locate, acquire, and consume food resources shaped their\ncharacteristics, community interactions, and the development of their complex behaviour to efficiently\nobtain food and survive (Roberts, 1942; McFarland, 1981). While, the availability of resources and\npredation are among the most important biotic drivers that shape interactions across wildlife\ncommunities (Talbot, 1978; Hiltunen & Laakso, 2013; Glen & Dickman, 2014). Within an ecosystem,\nwhen the predator populations decline or are absent, the prey population may dramatically increase\n(Gese & Knowlton, 2001; Ritchie et al., 2013). This release of a species numbers may have negative\nimplications especially when the prey is an invasive and out-compete native species for space and\nother resources (Ritchie et al., 2013) therefore, predator plays a crucial role to balance the prey\npopulation. Predation is a complex behaviour and can involve many different approaches, these\ninclude (1) \xe2\x80\x98cooperation\xe2\x80\x99 when hunting occurs in a pair or group, (2) \xe2\x80\x98cheating\xe2\x80\x99 when hunters spot\nprey but only join at the end of a hunt (3) \xe2\x80\x98scavenging\xe2\x80\x99 when hunters do not hunt but join whenever it\nhas a chance to take food or when predators consume carrion (DeVault et al., 2003), and (4) \xe2\x80\x98solitary\xe2\x80\x99\nwhere predator hunts alone (Packer & Ruttan, 1988).\nUntil a recent global review the extent of bird predation on bats was not widely known\n(Mikula et al., 2016). Diurnal birds particularly raptors prey on at least 124 species (11 families) of\nbats (Mikula et al., 2016). Hunting and predation by birds frequently occur near caves and roosting\n\n\x0cbioRxiv preprint first posted online Feb. 15, 2019; doi: http://dx.doi.org/10.1101/550582. The copyright holder for this preprint\n(which was not peer-reviewed) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity.\nIt is made available under a CC-BY-NC-ND 4.0 International license.\n\nareas where bats are abundant and predators can hunt bats at emergence and during foraging\n(Laycock, 1982; Lee & Kuo, 2001; Stimpson, 2009). Inside caves and underground ecosystems,\nreptiles particularly snakes are widely known predators for cave-dwelling bats while varanids\n(monitor lizards) have not previously been reported. In the Asian tropics, few bat predators have been\ndocumented and there may be more interactions unreported (Lima & O'Keefe, 2013; Mikula et al.,\n2016). In the Philippines, large Raptors (Family: Accipitridae) and pythons have been noted to prey\non tree roosting flying fox Acerodon jubatus (van Weerd et al., 2003) nonetheless this is the first\nclearly documented and described observation of crow predation on cave-dwelling bats (Tanalgo &\nHughes, 2018). In this paper, we investigated and offer potential reasons in the cooperative hunting\nbehaviour in Large-billed Crow (Corvus macrorhynchos) and opportunistic hunting in Yellow-headed\nwater monitor (Varanus cumingi) in Monfort bat cave, Mindanao, Philippines.\nMethods and Results\nLocale of the observation\nWe conducted field observation on the Island of Samal located within the Gulf of Davao in\nthe southern part of the Philippine Archipelago at the world's largest colony of the Geoffroy's\nRousette (Rousettus amplexicaudatus, Chiroptera: Pteropodidae) (estimated population at present 2\nmillion) (Carpenter et al., 2014) in the Monfort Bat Cave (7o09\xe2\x80\x9953\xe2\x80\x99\xe2\x80\x99N, 125o41\xe2\x80\x9931\xe2\x80\x99\xe2\x80\x99). The rousette bat\nis a medium-sized cave-dwelling fruit bat native to Southeast Asia (Csorba et al. 2008) and widely\ndistributed throughout the Philippines (Heaney et al. 2010). Monfort Bat Cave is located in the private\nMonfort Bat Sanctuary and was opened for external ecotourism in 2005. Scientific research is allowed\nand several studies have been made before. Monfort Bat Cave is a relatively small cave with an\napproximate size of 150-metre length with an average 3 metres high and 5 metres wide. The cave\nsystem can be accessed through its horizontal entrance (opening #1) and four vertical openings\n(Carpenter et al., 2014).\nCooperative hunting by Large-billed crows Corvus macrorhynchos\nC. macrorhyncus is a common crow species widely distributed throughout the Asian region\nand are territorial and monogamous birds, often found in forested areas, coastal areas, plantations, and\nhighly common in urban areas and co-exist with human settlements (Tanalgo & Achondo, in-review).\nThese species are documented as omnivorous but they appear to be carnivorous in areas where animal\nprey are abundantly available (Goodwin, 1982; Richardson & Verbeek, 1997; Tanalgo et al., 2015). In\nSoutheast Asia, C. macrorhyncus has previously been recorded to prey on Cynopterus sphinx while\nthe co-occurring species C. enca is known to prey on Tadarida plicata (as accounted by Mikula et al.,\n2016). Other documented crow prey from Asian region include young of domestic cats (Felis catus),\nmurids, rock doves (Columba livia), Grey Starlings (Sturnus cineraceus), and Tree Sparrows (Passer\nmontanus) (Kurosawa et al., 2003). Previous records of bat predation of Myotis lucifugus by the\nAmerican Crow (Corvus brachyrhynchos) in North America largely focuses on crow attacks on bats\nduring flight and do not enter caves to hunt (Lefevre, 2005; Henandez et al., 2007; Flaspohler, 2017).\nIn Monfort cave, crows have been known to predate bats since 2006 but their behaviour not\nrecorded in depth. In late 2018 (September to December) R. amplexicaudatus approximately 5-10\nmetres away from the entrances of five chambers of the cave. Further, we repeatedly observed crows\nperching on the trees surrounding the cave and flying into the cave preying upon the bats. In the\nsucceeding months, we evaluated and described the patterns of predation. We observed crow activity\n50 metres away from the cave opening and reinforced our observation by strategically installing a\nsingle wireless microcamera (TT microcamera\xe2\x84\xa2, P.R. China coupled with TT Android-based\napplication support) at the first and third cave openings starting from 0700 H to 1700 H. Over 60\nobservational hours were made in the study site.\nWe observed 10 to 15 crows (Corvus macrorhyncus) flocking on trees 10 metres away from\nthe caves. Two groups then form with group A is on standby (~9 to 10 individuals), perching on tree\nbranches around the caves while group B (~2-7 individuals) perch on the fence or vines near the\nopening strategizing the population it will attack to initiate the hunting. Coordinated hunting begins\n\n\x0cbioRxiv preprint first posted online Feb. 15, 2019; doi: http://dx.doi.org/10.1101/550582. The copyright holder for this preprint\n(which was not peer-reviewed) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity.\nIt is made available under a CC-BY-NC-ND 4.0 International license.\n\nwith surveillance behaviour, which is the longest phase that occasionally lasted up to an estimated 1015 minutes. Crows are occasionally observed producing loud calls whilst they remained near the cave\nopenings taking advantage of perching on tree branches or canopy vines. The third stage or the\n\xe2\x80\x98hunting\xe2\x80\x99 begins when the crow hunters (group B) flew rapidly towards the cave entrance, hover, and\nmob the roosting bats to distract the clumping population in the uppermost to mid-part part of the cave\nopenings causing the population to dilute that makes it easier for the hunters to capture bats. The\nhunting group will then forcefully capture the bats using their beaks and emerge from the cave. This\nstage takes a maximum time of 8.78 minutes with an average of 2.20 minutes (n=26 hunting bouts).\n\nFigure 1. A diagram illustrating the cooperative hunting in crows (C. macrorrhyncos) (A-E) and solitary hunting of\nwater monitor V. cumingi on cave-dwelling bat Rousettus amplexicaudatus in Samal Island, Philippines.\n\nThe hunting phase is not always successful in the 1st attempt and takes another 2nd to 3rd attempts for\nthe same hunters to successfully capture a prey. The fourth and last stage is when hunting group\n(group B) emerge from the cave where the group A are waiting and will fight with the murder until\nthey rip up the bat individuals then fly off away from the cave. Typically, during each 2-3 hunting\ncrows could successfully kill single bat individual (graphically described in Figure 1). Sometimes a\nbat escapes and flies outside the cave, group A that is on stand-by will follow and attack the bats and\nrip them apart. This behaviour starts to be active from 0600 H to 0800 H, 1200 H to 1300 H and\nrecurs throughout the day and each hunting phases are variable but the relative length is consistent\nuntil 1600 H to 1700 H before the bat emergence. This is due to the human presence in the vicinity of\nthe cave as crows may disappear and pause bat hunting when tourists or the observers are noticeably\npresent (e.g., numerous groups of tourist are present and noisy). Noticeably, days with a larger\nnumber of tourists the frequency of crow hunting bouts is lower (between 2 to 3 times per hour)\ncompared to 6-8 times per hour on days with a lower number of visiting tourists. Additionally,\nbecause the exact population of crows we observed in the study is not certain we cannot determine if\nthe same individuals perform the same role. The hunting success rate of crows are frequently\nsuccessful but the distribution of food (e.g., amount of meat) varies and mostly favours the group B\n(hunters).\n\nOpportunistic Hunting by Varanus cumingi\n\n\x0cbioRxiv preprint first posted online Feb. 15, 2019; doi: http://dx.doi.org/10.1101/550582. The copyright holder for this preprint\n(which was not peer-reviewed) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity.\nIt is made available under a CC-BY-NC-ND 4.0 International license.\n\nIn addition to coordinated hunting by large-billed crows, we also documented solitary\nopportunistic predation by V. cumingi on R. amplexicaudatus. Unlike other Philippine endemic\nvaranids (e.g., Varanus olivaceus, V. mabitang, and V. bitatawa) that are frugivorous (Koch et al.,\n2010; Law et al., 2018), V. cumingi is chiefly carnivorous and common in mangroves, fishponds, and\ntropical forests (Losos & Greene 1988, Koch et al. 2007; Sy et al. 2009). According to historical\naccounts, V. cumingi are resident cave dweller and chiefly remain inside, rarely venturing out where\nthey are vulnerable to hunting (Tata Albeti, pers. comm.). We observed two large V. cumingi preying\nsolitarily on roosting bats in the lower part of the cave where less active (adult, sleeping, or ill) bats\nare located. V. cumingi predation is swift and more efficient compared to crow predation. The\npredation mode of V. cumingi is solitary and it starts with surveillance, which takes only a few\nminutes (~2 to 3 minutes). Once a lizard finds its potential prey, it will immediately attack the prey\nand swallows the whole bat (taking 5-8 minutes). After swallowing the prey, it hides and rests under\nthe boulders below the cave. Based on cave morphology, patterns of bats roosting in the cave, and\nlikely behaviour of V. cumingi, we believe the lizard preys upon bats roosting on the lower cave walls\nas well as on and underneath the rock breakdown in a cave. They are likely more successful preying\nupon vulnerable bats that are injured, sick, older, or younger. There are instances of smaller varanids\nattempting to capture bats in the upper part walls but these frequently fail.\nDiscussion\nThis is the first description and documentation of cooperative hunting and solitary\nopportunistic hunting by large-billed crow C. macrorrhyncos and V. cumingi respectively on the cavedwelling bat species, R. amplexicaudatus. Cooperative hunting is uncommon but has been widely\ndocumented in a few vertebrate groups and it is described as opportunistic or individually\nsimultaneous hunt (Bernarz, 1988; Packer & Ruttan, 1988; Dinets 2017). This behaviour occurs when\ntwo or more individuals cooperate to hunt larger or more active prey to improve hunting success and\nreduce energy expenditure (Hector, 1986; Bernarz, 1988; Bowman et al., 2003). In our present\nobservation, we observed members of the hunting murders mob and disturb prey groups to become\nmore vulnerable and easier for other members to hunt, eventually when hunting succeeds hunters will\nascend from the cave carrying a dead prey for other to rip apart and consume. This observed\nbehaviour provides evidence of cooperative hunting among crows within the same group (hunters)\nand other groups (non-hunting). This hunting strategy is best identified and described based on\napparently observed coordination of the group or flocks, for example, each member attacks prey\nsequentially, which the hunters allow others groups to take advantage situation and benefit from it\n(Dinet, 2015). For example, in the case of Cuban boas (Chilabothrus angulifer) they block cave bats\nin the passage to increase hunting efficacy giving an advantage to other groups (Dinets et al., 2017).\nCooperation is widely known for corvids and has been documented in many species of crows in the\nwild (e.g., Bowman, 2003; Yosef & Yosef, 2010). Our present observation on C. macrorhyncus\nshared a similar pattern of intelligent cooperative hunting behaviour of C. rufficollins on Egyptian\nmastigure Uromastyx aegypticus, where crows divide into groups to perform coordinated hunting of\nthe prey and are aware of their roles (see Yosef & Yosef, 2009). In addition, although not described in\nthe present study, the cooperation success among Corvus depends on inter-individual tolerance, and\nthey cease cooperation if other group members cheat (Massen et al., 2015).\nHowever, cooperative hunting strategy does not always assure higher food intake (e.g., Mech\n& Boitani, 2003 demonstrated on grey wolf) or if the prey is smaller only those successful predators\ncan take advantage (Packer & Ruttan, 1988). In our present observation, in cooperative hunting in\ncrows, we observed that food intake mostly favours those groups that do the hunting actively (e.g.,\ngroup B) compared to those in standby and waiting. While Varanus cumingi hunting strategy is\nsolitary and opportunistic hunting, where it avoids conspecifics and therefore hunts solitarily. Most\nVaranus species prey on smaller vertebrates such as frogs and birds, but larger species can eat large\nanimals as big as deer (Losos & Greene, 1988). Archaeological evidence shows large monitor lizards\ndwelling in caves (Price et al. 2015) but contemporary evidence on varanid feeding on caves bats has\nnot previously been recorded.\nTwo plausible explanations we can offer at present to explain potential drivers that may have\ninfluenced predator behaviour towards the cave bats. First, the \xe2\x80\x98doomed surplus paradigm\xe2\x80\x99, which\npredators take advantage and hunt the overcrowded population (Errington, 1946). In this concept, it is\n\n\x0cbioRxiv preprint first posted online Feb. 15, 2019; doi: http://dx.doi.org/10.1101/550582. The copyright holder for this preprint\n(which was not peer-reviewed) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity.\nIt is made available under a CC-BY-NC-ND 4.0 International license.\n\noften assumed that preyed upon individuals were low-quality populations, and the predators play a\nrole to assure check and balance in the health of the population. Our observation on V. cumingi solely\npredates vulnerable individuals (i.e., weak or presumably sick, old, or injured) while C.\nmacrorhynchos hunts on individuals that roost in abundant clumps. Secondly, the population\n\xe2\x80\x98spillover effects\xe2\x80\x99 may have influenced the increase in bat biomass and predator influx in the cave.\nAlthough this concept is widely discussed and applied in marine reserves where no-take reserves\nincrease and enhance the community complexity (e.g., species diversity and functional groups) due to\nthe improvement of habitat quality and abundance of the prey availability and recruit predators (Russ\n& Alcala, 2011). In the case of Monfort bat cave, predator recruitment is driven by the stable\npopulation of R. amplexicaudatus population due to absent of disturbances such as hunting and cave\nintrusion. Predators in Monfort Bat Cave are likely important to help maintain the ecological balance\nof the large aggregation of R. amplexicaudatus in the cave system. In addition to our documentation\nof predation by C. macrorhynchos and V. cumingi, pythons and large numbers of rats also live in the\ncave and have been observed to prey upon the bats. Moreover, we speculate another hypothesis that\nthe presence of these predators may explain and shed light on the \xe2\x80\x98anecdotally abnormal\xe2\x80\x99 behaviour of\nR. amplexicaudatus in the cave in addition to overcrowding.\nWhat is more, the predation of two predators on a cave-dwelling bat R. amplexicaudatus\noffers another understanding of ecological interactions present within caves and underground habitats.\nAlthough this is not the first time for corvids to be documented and described to perform cooperative\nhunting, our study has provided additional insight to support the capacity of crows to perform such\ncomplex behaviour on a different prey and ecological instances (e.g., caves) and that this behaviour is\ncommon rather than rare. In addition, we have also shown here modes of predation influence animal\nbehaviour (e.g., the frequency of hunting and food intake). Therefore, corvids and varanids are\ninteresting model taxa to explore and elucidate the comparative evolution and mechanism of\ncooperation in the animal kingdom.\nAcknowledgements\nThis work is supported by the Chinese National Natural Science Foundation (Grant #:\nU1602265, Mapping Karst Biodiversity in Yunnan), Strategic Priority Research Program of the\nChinese Academy of Sciences (Grant #: XDA20050202), Chinese Academy of Sciences Southeast\nAsia Biodiversity Research Center fund (Grant #: Y4ZK111B01), and SEABA: Southeast Asian Atlas\nof Biodiversity (Grant #: Y5ZK121B01). This is a part of the PhD project of KCT supported by the\nXishuangbanna Tropical Botanical Garden, University of Chinese Academy of Sciences, and the\nChinese Government Scholarship council, P.R. China. The authors are also grateful to Emerson Y. Sy\n(Philippine Center for Terrestrial and Aquatic Research) for verifying the varanid species and Monfort\nBat Cave staff for their assistance during the observations and fieldwork in Monfort cave.\nSupplementary\nCrow hunting on cave bats\nhttps://doi.org/10.6084/m9.figshare.7701269\nhttps://doi.org/10.6084/m9.figshare.7701281\nhttps://doi.org/10.6084/m9.figshare.7701290\nVaranid predation\nhttps://doi.org/10.6084/m9.figshare.7701443\n\nReferences\nBednarz, J.C. (1988). Cooperative hunting Harris' hawks (Parabuteo unicinctus). Science, 239, 15251527.\nBowman, R. (2003). Apparent cooperative hunting in Florida scrub jays. The Wilson Bulletin, 115,\n197-199.\n\n\x0cbioRxiv preprint first posted online Feb. 15, 2019; doi: http://dx.doi.org/10.1101/550582. The copyright holder for this preprint\n(which was not peer-reviewed) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity.\nIt is made available under a CC-BY-NC-ND 4.0 International license.\n\nCarpenter, E., Gomez, R., Waldien D.L., & Sherwin R.E. (2014). Photographic estimation of roosting\ndensity of Geoffroys Rousette Fruit Bat Rousettus amplexicaudatus (Chiroptera: Pteropodidae)\nat Monfort Bat Cave, Philippines. Journal of Threatened Taxa, 6, 5838-5844.\nCsorba, G., Rosell-Ambal, G., & Ingle, N. (2008). Rousettus amplexicaudatus. The IUCN Red List of\nThreatened Species 2008:\ne.T19754A9010480. http://dx.doi.org/10.2305/IUCN.UK.2008.RLTS.T19754A9010480.en.\nDownloaded on 18 January 2019.\nDeVault, T. L., Rhodes, Jr, O. E., & Shivik, J. A. (2003). Scavenging by vertebrates: behavioral,\necological, and evolutionary perspectives on an important energy transfer pathway in terrestrial\necosystems. Oikos, 102, 225-234.\nDinets, V. (2015). Apparent coordination and collaboration in cooperatively hunting\ncrocodilians. Ethology Ecology & Evolution, 27, 244-250.\nDinets, V. (2017). Coordinated hunting by Cuban boas. Animal Behavior and Cognition, 4, 24-29.\nErrington, P.L. (1946). Predation and vertebrate populations. The Quarterly Review of Biology, 21,\n144-177.\nFlaspohler, D.J. (2017). American Crows (Corvus brachyrhynchos) Enter Abandoned Mine to Hunt\nBats. The Wilson Journal of Ornithology, 129, 394-397.\nGese, E.M., & Knowlton, F.F. (2001). The role of predation in wildlife population dynamics. Pages 725 in The Role of Predator Control as a Tool in Game Management. Edited by T. F. Ginnetr\nand S. E. Henke. Texas Agricultural Research and Extension Center. San Angelo. Texas.\nGlen, A.S., & Dickman R. (2014). The importance of predators. In Carnivores of Australia: Past,\nPresent and Future. CSIRO Publishing, 2014. 438 pp.\nGoodwin, D. (1982). Crows of the world. 2nd ed. British Museum Natural History, London.\nHeaney, L.R., Dolar, M.L., Balete, D.S., Esselstyn, J.A., Rickart, A.E., Sedlock, J.L. (2010). Synopsis\nof Philippine Mammals. The Field Museum of Natural History in cooperation with the\nPhilippine Department of Environment and Natural Resources - Protected Areas and Wildlife\nBureau. http://archive.fieldmuseum.org/philippine_mammals accessed December 10 2016.\nHern\xc3\xa1ndez, D.L., Mell, J.J., & Eaton, M.D. (2007). Aerial predation of a bat by an American\nCrow. The Wilson Journal of Ornithology, 119, 763-764.\nHiltunen, T., & Laakso, J. (2013). The relative importance of competition and predation in\nenvironment characterized by resource pulses\xe2\x80\x93an experimental test with a microbial\ncommunity. BMC Ecology, 13, 29.\nKoch, A., Auliya, M., & Ziegler, T. (2010). Updated checklist of the living monitor lizards of the\nworld (Squamata: Varanidae). Bonn Zoological Bulletin, 57, 127-136.\nKoch, A., Auliya, M., Schmitz, A., Kuch, U., & B\xc3\xb6hme, W. (2007). Morphological studies on the\nsystematics of South East Asian water monitors (Varanus salvator Complex): nominotypic\npopulations and taxonomic overview. Mertensiella, 16, e80.\nKurosawa, R., Kono, R., Kondo, T., & Kanai, Y. (2003). Diet of jungle crows in an urban\nlandscape. Global Environmental Research, 7, 193-198.\nLaw, S.J., De Kort, S.R., Bennett, D., & Van Weerd, M. (2018). Diet and Habitat Requirements of the\nPhilippine Endemic Frugivorous Monitor Lizard Varanus bitatawa. Biawak, 12, 12-22.\nLaycock, P. (1982). Avian predation on cave dwelling insectivorous bats. Bokmakierie, 34, 17-18.\nLee, Y.F., & Kuo, Y.M. (2001). Predation on Mexican free-tailed bats by peregrine falcons and redtailed hawks. Journal of Raptor Research, 35, 115-123.\nLefevre, K.L. (2005). Predation of a bat by American Crows, Corvus brachyrhynchos. Canadian\nField Naturalist, 119, 443\xe2\x80\x93444.\nLima, S.L., & O'keefe, J.M. (2013). Do predators influence the behaviour of bats? Biological\nReviews, 88, 626-644.\nLosos, J. B., & Greene, H. W. (1988). Ecological and evolutionary implications of diet in monitor\nlizards. Biological Journal of the Linnean Society, 35, 379-407.\nMassen, J. J., Ritter, C., & Bugnyar, T. (2015). Tolerance and reward equity predict cooperation in\nravens (Corvus corax). Scientific Reports, 5, 15021.\nMcFarland, D. (1981). The Oxford Companion to Animal Behavior. Oxford University Press, New\nYork.\n\n\x0cbioRxiv preprint first posted online Feb. 15, 2019; doi: http://dx.doi.org/10.1101/550582. The copyright holder for this preprint\n(which was not peer-reviewed) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity.\nIt is made available under a CC-BY-NC-ND 4.0 International license.\n\nMech, L. D., & Boitani, L. (2003). Wolves: Behavior, Ecology, and Conservation. Chicago, IL:\nUniversity of Chicago Press.\nMikula, P., Morelli, F., Lu\xc4\x8d an, R.K., Jones, D.N., & Tryjanowski, P. (2016). Bats as Prey of Diurnal\nBirds: A global perspective. Mammal Review, 46, 160-174.\nPacker, C., & Ruttan, L. (1988). The evolution of cooperative hunting. The American Naturalist, 132,\n159-198.\nPrice, G.J., Louys, J., Cramb, J., Feng, Y.X., Zhao, J.X., Hocknull, S.A., & Joannes-Boyau, R. (2015).\nTemporal overlap of humans and giant lizards (Varanidae; Squamata) in Pleistocene\nAustralia. Quaternary Science Reviews, 125, 98-105.\nRichardson, H., & Verbeek, N.A. (1987). Diet selection by yearling northwestern crows (Corvus\ncaurinus) feeding on littleneck clams (Venerupis japonica). The Auk, 263-269.\nRitchie, E.G., Elmhagen, B., Glen, A.S., Letnic, M., Ludwig, G., & McDonald, R.A. (2012).\nEcosystem restoration with teeth: what role for predators? Trends in Ecology & Evolution, 27:\n265-271.\nRoberts, T.W. (1942). Behavior of Organisms. Ecological Monographs, 12, 339-412.\nRuss, G.R., & A.C. Alcala. (2011). Enhanced biodiversity beyond marine reserve boundaries: The cup\nspillith over. Ecological Applications, 21, 241-250.\nStimpson, C.M. 2009. Raptor and owl bone from Niah Caves, Sarawak: identifications and\nmorphological variation in the humerus and tarsometatarsus of selected raptors. International\nJournal of Osteoarchaeology, 19, 476-490.\nSy, E., Diesmos, A., Jakosalem, P.G., Gonzalez, J.C., Paguntalan, L.M., Demegillo, A. Custodio, C.,\nDelima, E., Tampos, G., Gaulke, M., & Jose, R. (2009). Varanus cumingi. The IUCN Red List\nof Threatened Species 2009: e.T169897A6687602. http://dx.doi.org/10.2305/IUCN.UK.20092.RLTS.T169897A6687602.en. Downloaded on 19 January 2019.\nTalbot, L.M. (1978). The Role of Predators in Ecosystem Management. In: Holdgate M.W.,\nWoodman M.J. (eds) The Breakdown and Restoration of Ecosystems. NATO Conference\nSeries (Series I: Ecology), vol 3. Springer, Boston, MA\nTanalgo, K.C., & Achondo, M.J.M. In-review. Bird distribution differs across habitat types in\nSouthcentral Mindanao, Philippines: implications for conservation and future developments in\nthe region.\nTanalgo, K.C., & Hughes, A.C. (2018). Bats of the Philippine Islands \xe2\x80\x93 a review of research\ndirections and relevance to national-level priorities and targets. Mammalian Biology, 91, 46-56.\nTanalgo, K.C., Pineda, J.A.F., Agravante, M.E., & Amerol, Z.M. (2015). Bird diversity and structure\nin different land-use types in lowland south-central Mindanao, Philippines. Tropical Life\nSciences Research, 26, 85-103.\nVan Weerd, M. et al. 2003. Flying foxes of the Northern Sierra Madre. In The Sierra Madre Natural\nPark, Northeast Luzon. In: Van der Ploeg, J., E.C. Bernardo and A.B. Masipiquena (eds.)\nMountain range: global relevance, local realities. CVPED and Golden Press, Tuguegarao, the\nPhilippines, pp. 54-62\nYosef, R., & Yosef, N. (2010). Cooperative hunting in brown-necked raven (Corvus rufficollis) on\nEgyptian mastigure (Uromastyx aegyptius). Journal of Ethology, 28, 385-388.\n\n\x0c"
    t = clean_text(t)
    find_abstract_one_match(t)

def remove_bioarch_text(text):
    regString01 = 'bioRxiv preprint first posted online[\s\S]+?No reuse allowed without permission|'
    regString02 = 'bioRxiv preprint first posted online[\s\S]+?It is made available under.+?license|'
    regString03 = 'bioRxiv preprint first posted online[\s\S]+?without crediting the original authors|'
    regString04 = 'bioRxiv[\s\S]+?for use under a CC.+?license|'
    regString05 = 'bioRxivpreprint[\s\S]+?all rights reserved. No reuse allowed without permission|'
    regString06 = 'bioRxiv.+CC-BY-N'

    pattern = regString01 + regString02 + regString03 + regString04 + regString05 + regString06
    regAll = r"{}".format(pattern)
    regex = re.compile(regAll,re.IGNORECASE)
    text = re.sub(regex,'** BIO ARCH REMOVED **',text)
    return text


def extract_abstract(text, clean=False):
    text = clean_text(text)
    ab = find_abstract_one_match(text)
    if(ab != NO_AB):
        ab = clean_ab_chunk(ab)
        ab = remove_bioarch_text(ab)

    if(clean):
        return clean_before_processing(ab)
    else:
        return ab

def clean_before_processing(abstract_text):
    return clean_removed_strings(abstract_text)
